---
import PostLayout from '../../layouts/PostLayout.astro';
import { getCollection, getEntryBySlug } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map(post => ({ params: { slug: post.slug } }));
}

const { slug } = Astro.params;
const post = await getEntryBySlug('posts', slug);
const { Content } = post ? await post.render() : { Content: null };
---

{post && Content ? (
  <PostLayout frontmatter={post.data}>
    <Content />
  </PostLayout>
) : (
  <main class="container" style="padding:2rem 0;">
    <article class="card">
      <h1>Página em construção</h1>
      <p>Este conteúdo ainda não está disponível. Volte em breve!</p>
    </article>
  </main>
)}
