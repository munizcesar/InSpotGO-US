---
import PostLayout from '../../layouts/PostLayout.astro';
// Note: Astro content fetching is placeholder â€” replace with your content adapter if needed
const slug = Astro.params.slug;
let post = null;
try {
  // Attempt to load markdown file from content folder
  post = await Astro.resolve(`./../../content/posts/${slug}.md`).catch(() => null);
} catch(e) {
  post = null;
}

import fs from 'fs';
import path from 'path';

export async function getStaticPaths() {
  const postsDir = path.resolve('./src/content/posts');
  const files = fs.readdirSync(postsDir);
  const paths = files
    .filter((file) => file.endsWith('.md'))
    .map((file) => ({ params: { slug: file.replace(/\.md$/, '') } }));
  return paths;
}
---
{post ? (
  <PostLayout frontmatter={post.frontmatter}>
    <div set:html={post.body} />
  </PostLayout>
) : (
  <main class="container" style="padding:2rem 0;">
    <article class="card"><h1>Post not found</h1></article>
  </main>
)}
